<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[phlipper's (dot) net]]></title>
  <link href="http://phlipper.github.com/atom.xml" rel="self"/>
  <link href="http://phlipper.github.com/"/>
  <updated>2012-07-03T14:44:23-07:00</updated>
  <id>http://phlipper.github.com/</id>
  <author>
    <name><![CDATA[Phil Cohen]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Improved concurrency for Heroku Dynos]]></title>
    <link href="http://phlipper.github.com/blog/2012/07/03/improved-concurrency-for-heroku-dynos/"/>
    <updated>2012-07-03T10:34:00-07:00</updated>
    <id>http://phlipper.github.com/blog/2012/07/03/improved-concurrency-for-heroku-dynos</id>
    <content type="html"><![CDATA[<p>A Rack application running on <a href="http://heroku.com">Heroku</a> can improve performance by using different application servers with different performance characteristics.</p>

<p>Some good choices include <a href="http://code.macournoyer.com/thin/">Thin</a> (evented I/O), <a href="http://unicorn.bogomips.org/">Unicorn</a> (multi-process) and <a href="http://puma.io/">Puma</a> (multi-threaded).</p>

<p>The exact configuration settings will vary by application and how much memory each app takes. A default Rails app with a basic scaffold can easily support 4 unicorn workers or 4 puma threads. A small Sinatra app can support several times that number.</p>

<p>Here are the <code>Procfile</code> settings you can use for each:</p>

<figure class='code'><figcaption><span>Procfile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># thin</span>
</span><span class='line'><span class="n">web</span><span class="p">:</span> <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">thin</span> <span class="o">-</span><span class="nb">p</span> <span class="vg">$PORT</span> <span class="o">-</span><span class="n">e</span> <span class="vg">$RACK_ENV</span> <span class="n">start</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># puma</span>
</span><span class='line'><span class="n">web</span><span class="p">:</span> <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">puma</span> <span class="o">-</span><span class="n">t</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span> <span class="o">-</span><span class="n">b</span> <span class="n">tcp</span><span class="ss">:/</span><span class="o">/</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="p">:</span><span class="vg">$PORT</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># unicorn</span>
</span><span class='line'><span class="n">web</span><span class="p">:</span> <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">unicorn</span> <span class="o">-</span><span class="nb">p</span> <span class="vg">$PORT</span> <span class="o">-</span><span class="n">c</span> <span class="o">.</span><span class="n">/config</span><span class="o">/</span><span class="n">unicorn</span><span class="o">.</span><span class="n">rb</span>
</span></code></pre></td></tr></table></div></figure>


<p>Use the <a href="https://addons.heroku.com/newrelic">New Relic RPM Add-on</a> to monitor your application resources.</p>
]]></content>
  </entry>
  
</feed>
