<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: ruby | phlipper's (dot) net]]></title>
  <link href="http://phlippers.net/blog/categories/ruby/atom.xml" rel="self"/>
  <link href="http://phlippers.net/"/>
  <updated>2012-07-11T11:08:11-07:00</updated>
  <id>http://phlippers.net/</id>
  <author>
    <name><![CDATA[Phil Cohen]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Fix Ruby 1.9.x OpenSSL Segfault on OS X]]></title>
    <link href="http://phlippers.net/blog/2012/07/10/fix-ruby-1-dot-9-x-openssl-segfault-on-os-x/"/>
    <updated>2012-07-10T22:37:00-07:00</updated>
    <id>http://phlippers.net/blog/2012/07/10/fix-ruby-1-dot-9-x-openssl-segfault-on-os-x</id>
    <content type="html"><![CDATA[<p>If you install Ruby 1.9.2 or 1.9.3 on OS X, you may run in to the dreaded OpenSSL segfault:</p>

<pre><code>~/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:799: [BUG] Segmentation fault
ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-darwin11.4.0]
</code></pre>

<p>The version of OpenSSL that ships with OS X 10.6 and 10.7 is older and causes this issue.</p>

<p>There are a number of options solve this. Here a few:</p>

<p><strong>MacPorts</strong></p>

<pre><code>$ port selfupdate
$ port install openssl
$ port install libyaml

# RVM
$ rvm install 1.9.3 --with-openssl-dir=/opt/local --with-opt-dir=/opt/local

# rbenv
$ CONFIGURE_OPTS='--with-openssl-dir=/opt/local --with-opt-dir=/opt/local' rbenv install 1.9.3-p194
</code></pre>

<p><strong>Homebrew</strong></p>

<pre><code>$ brew update
$ brew install openssl

# RVM
$ rvm install 1.9.3 --with-openssl-dir=`brew --prefix openssl`

# rbenv
$ CONFIGURE_OPTS="--with-openssl-dir=`brew --prefix openssl`" rbenv install 1.9.3-p194
</code></pre>

<p><strong>RVM</strong></p>

<pre><code>$ rvm pkg install openssl
$ rvm reinstall 1.9.3 --with-openssl-dir=$rvm_path/usr
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Improved concurrency for Heroku Dynos]]></title>
    <link href="http://phlippers.net/blog/2012/07/03/improved-concurrency-for-heroku-dynos/"/>
    <updated>2012-07-03T10:34:00-07:00</updated>
    <id>http://phlippers.net/blog/2012/07/03/improved-concurrency-for-heroku-dynos</id>
    <content type="html"><![CDATA[<p>A Rack application running on <a href="http://heroku.com">Heroku</a> can improve performance by using different application servers with different performance characteristics.</p>

<p>Some good choices include <a href="http://code.macournoyer.com/thin/">Thin</a> (evented I/O), <a href="http://unicorn.bogomips.org/">Unicorn</a> (multi-process) and <a href="http://puma.io/">Puma</a> (multi-threaded).</p>

<p>The exact configuration settings will vary by application and how much memory each app takes. A default Rails app with a basic scaffold can easily support 4 unicorn workers or 4 puma threads. A small Sinatra app can support several times that number.</p>

<p>Here are the <code>Procfile</code> settings you can use for each:</p>

<p>```ruby Procfile</p>

<h1>thin</h1>

<p>web: bundle exec thin -p $PORT -e $RACK_ENV start</p>

<h1>puma</h1>

<p>web: bundle exec puma -t 1:4 -b tcp://0.0.0.0:$PORT</p>

<h1>unicorn</h1>

<p>web: bundle exec unicorn -p $PORT -c ./config/unicorn.rb
```</p>

<p>Use the <a href="https://addons.heroku.com/newrelic">New Relic RPM Add-on</a> to monitor your application resources.</p>
]]></content>
  </entry>
  
</feed>
